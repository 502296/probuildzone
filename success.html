<!doctype html><html lang="en"><head>

<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">

<title>Payment Successful – ProBuildZone</title>

<style>

  body{font-family:Inter,system-ui,Arial;margin:0;background:#0f2a43;color:#fff;display:grid;place-items:center;min-height:100vh}

  .card{background:#122c46;padding:28px 32px;border-radius:14px;max-width:560px;box-shadow:0 12px 28px rgba(0,0,0,.3)}

  h1{margin:0 0 10px;font-size:26px}

  p{opacity:.9;line-height:1.6}

  a.btn{display:inline-block;margin-top:14px;padding:10px 16px;border-radius:10px;background:#f28c1b;color:#0f2a43;text-decoration:none;font-weight:600}

</style>

</head><body>

  <div class="card">

    <h1>🎉 You’re in!</h1>

    <p>Thanks for starting your 30-day free trial. We’ve received your details and payment setup via Stripe.</p>

    <p>We’ll activate your Pro profile shortly. If you need help, email <a href="mailto:contact@probuildzone.com">contact@probuildzone.com</a>.</p>

    <a class="btn" href="/index.html">Back to Home</a>

  </div>

  <script>

  // 1) قراءة session_id من لينك Stripe

  const u = new URL(window.location.href);

  const session_id = u.searchParams.get('session_id') || '';



  // 2) قراءة بيانات النموذج التي خزناها قبل الدفع

  const stored = sessionStorage.getItem('pbz_profile');

  const formData = stored ? JSON.parse(stored) : {};



  // 3) إرسالها إلى Netlify Function: save-profile

  fetch('/.netlify/functions/save-profile', {

    method:'POST',

    headers:{'Content-Type':'application/json'},

    body: JSON.stringify({

      ...formData,

      stripe_customer_id: '',

      stripe_subscription_id: '',

      session_id

    })

  })

  .then(r=>r.json())

  .then(()=>{

    // حذف التخزين حتى لا يتكرر الإرسال بالرجوع لنفس الصفحة

    sessionStorage.removeItem('pbz_profile');

    console.log('✅ Saved to Sheet');

  })

  .catch(err=>{

    console.warn('Failed to save profile', err);

  });

</script>

</body></html>
