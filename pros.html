
<!doctype html>

<html lang="en" dir="ltr">

<head>

  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>ProBuildZone — Pro Onboarding</title>

  <meta name="description" content="ProBuildZone Pro Onboarding" />

  <style>

    :root{

      --bg:#0F2A43;          /* الخلفية الجانبية */

      --card:#ffffff;        /* بطاقة الفورم */

      --text:#14212e;        /* نص أساسي */

      --muted:#6b7c8f;

      --accent:#d4af37;      /* ذهبي ناعم */

      --accent-press:#b7902c;

      --danger:#c92a2a;

      --ok:#0f9d58;

      --shadow:0 20px 40px rgba(0,0,0,.18);

      --radius:14px;

      --input:#f5f7fa;

      --border:#e6edf4;

    }

    *{box-sizing:border-box}

    body{

      margin:0;background:

      radial-gradient(1200px 500px at 50% -200px, rgba(255,255,255,.08), transparent),

      linear-gradient(180deg, #10304e 0%, #0b2238 100%);

      min-height:100vh; color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;

      display:flex; align-items:flex-start; justify-content:center; padding:40px 16px;

    }

    .wrap{width:100%; max-width:880px}

    .brand{

      color:#fff; font-weight:800; letter-spacing:.5px; font-size:22px; margin-bottom:18px; text-align:center;

    }

    .card{

      background:var(--card); border-radius:var(--radius); box-shadow:var(--shadow);

      padding:22px; border:1px solid var(--border);

    }

    .grid{display:grid; grid-template-columns:1fr 1fr; gap:16px}

    @media (max-width:720px){ .grid{grid-template-columns:1fr} }

    label{display:block; font-size:14px; color:var(--muted); margin:2px 4px 6px}

    input, select, textarea{

      width:100%; padding:14px 12px; border-radius:10px; border:1px solid var(--border);

      background:var(--input); outline:none; font-size:16px;

    }

    textarea{min-height:110px; resize:vertical}

    .row{margin-bottom:14px}

    .note{font-size:13px; color:var(--muted)}

    .actions{display:flex; gap:10px; margin-top:8px}

    .btn{

      display:inline-flex; align-items:center; justify-content:center; gap:8px;

      padding:12px 16px; border-radius:10px; border:1px solid transparent; cursor:pointer; font-weight:650;

      transition:.18s ease; user-select:none;

    }

    .btn.secondary{background:#f1f4f8; color:#233041}

    .btn.secondary:hover{background:#e8eef6}

    .btn.gold{background:var(--accent); color:#1a1a1a}

    .btn.gold:hover{background:var(--accent-press)}

    .btn[disabled]{opacity:.7; cursor:not-allowed}

    .check{display:flex; align-items:flex-start; gap:10px; margin:8px 0 2px}

    .error{margin-top:12px; padding:10px 12px; border:1px solid #ffd1d1; background:#fff4f4; color:var(--danger); border-radius:10px; display:none}

    .ok{margin-top:12px; padding:10px 12px; border:1px solid #ccebdc; background:#f2fbf6; color:var(--ok); border-radius:10px; display:none}

    .footer{text-align:center; color:#dbe6f3; font-size:12px; margin-top:14px}

    .spinner{width:16px;height:16px;border-radius:50%;border:3px solid rgba(0,0,0,.15);border-top-color:#000;animation:spin .9s linear infinite}

    @keyframes spin{to{transform:rotate(360deg)}}

  </style>

</head>

<body>

  <div class="wrap">

    <div class="brand">ProBuildZone</div>



    <div class="card">

      <form id="proForm" novalidate>

        <div class="grid">

          <div class="row">

            <label for="company">Business / Company</label>

            <input id="company" name="company" placeholder="e.g., Summit Builders LLC" autocomplete="organization" />

          </div>

          <div class="row">

            <label for="fullName">Owner Full Name</label>

            <input id="fullName" name="fullName" placeholder="Your full name" autocomplete="name" />

          </div>



          <div class="row">

            <label for="email">Email</label>

            <input id="email" name="email" type="email" placeholder="you@example.com" required autocomplete="email" />

          </div>

          <div class="row">

            <label for="phone">Phone</label>

            <input id="phone" name="phone" inputmode="tel" placeholder="(555) 555-5555" autocomplete="tel" />

          </div>



          <div class="row">

            <label for="address">Business Address</label>

            <input id="address" name="address" placeholder="Street, City, State" autocomplete="address-line1" />

          </div>

          <div class="row">

            <label for="insurance">Insurance (Optional)</label>

            <select id="insurance" name="insurance">

              <option value="">—</option>

              <option>General Liability</option>

              <option>Workers’ Compensation</option>

              <option>Bonded</option>

            </select>

          </div>



          <div class="row">

            <label for="license">Business License</label>

            <input id="license" name="license" placeholder="e.g., KY-123456" />

          </div>

          <div class="row">

            <label for="services">Services & Notes (optional)</label>

            <textarea id="services" name="services" placeholder="Tell homeowners what you do best…"></textarea>

          </div>

        </div>



        <div class="check">

          <input id="agree" type="checkbox" />

          <label for="agree" class="note">By starting your free trial, you agree to our <a href="#" target="_blank" rel="noopener">Terms</a> &amp; <a href="#" target="_blank" rel="noopener">Privacy</a>.</label>

        </div>



        <div class="actions">

          <button type="reset" class="btn secondary">Reset</button>

          <button id="pay" type="button" class="btn gold">

            <span class="label">Continue to Secure Payment</span>

            <span class="spinner" id="spin" style="display:none"></span>

          </button>

        </div>



        <div id="msgError" class="error"></div>

        <div id="msgOk" class="ok"></div>

      </form>

    </div>



    <div class="footer">© 2025 ProBuildZone — Fair Design • Local Pros</div>

  </div>



  <script>

    const $ = s => document.querySelector(s);

    const show = (el, b=true)=> el.style.display = b ? 'block' : 'none';



    const btn = $('#pay');

    const spin = $('#spin');

    const err = $('#msgError');

    const ok  = $('#msgOk');



    function setLoading(state){

      btn.disabled = state;

      show(spin, state);

      btn.querySelector('.label').textContent = state ? 'Redirecting…' : 'Continue to Secure Payment';

    }



    async function startCheckout(){

      err.textContent=''; show(err,false); show(ok,false);



      // تحقق بسيط

      if (!$('#email').value.trim()){

        err.textContent = 'Please enter a valid email.'; show(err,true); return;

      }

      if (!$('#agree').checked){

        err.textContent = 'Please accept Terms & Privacy to continue.'; show(err,true); return;

      }



      setLoading(true);

      try{

        const payload = {

          customer_email: $('#email').value.trim(),

          metadata: {

            company: $('#company').value.trim(),

            fullName: $('#fullName').value.trim(),

            phone: $('#phone').value.trim(),

            address: $('#address').value.trim(),

            license: $('#license').value.trim(),

            insurance: $('#insurance').value,

            notes: $('#services').value.trim(),

            source: 'pros_onboarding_v1'

          }

          // لو تريد خطة أخرى: أرسل priceId هنا

          // priceId: 'price_XXXX'

        };



        const res = await fetch('/.netlify/functions/create-checkout-session', {

          method: 'POST',

          headers: { 'Content-Type': 'application/json' },

          body: JSON.stringify(payload)

        });



        if (!res.ok){

          // لو رجعت 405 هنا فالغالب الزر كان submit أو الـfunction غير منشورة

          const text = await res.text();

          throw new Error(`Checkout failed (${res.status}). ${text.slice(0,120)}`);

        }



        const data = await res.json();

        if (data && data.url){

          window.location.href = data.url; // التحويل إلى Stripe

          return;

        }

        throw new Error('No redirect URL received from server.');

      } catch(e){

        console.error(e);

        err.textContent = e.message || 'Something went wrong. Please try again.';

        show(err,true);

        setLoading(false);

      }

    }



    btn.addEventListener('click', startCheckout);



    // منع أي submit افتراضي للفورم (سُترة أمان)

    document.getElementById('proForm').addEventListener('submit', e => e.preventDefault());

  </script>

</body>

</html>
