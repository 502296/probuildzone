<!doctype html>

<html lang="en" dir="ltr">

<head>

  <meta charset="utf-8"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <title>ProBuildZone â€” Start Free Trial</title>

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>

    :root{

      --pbz-blue:#0F2A43; --gold:#D4AF37; --gold-700:#b9962f;

      --muted:#6b7a8c; --card:#ffffff;

    }

    *{box-sizing:border-box}

    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#fff;color:#111}

    .container{max-width:780px;margin:32px auto;padding:16px}

    .card{background:var(--card);border:1px solid #e7e8ec;border-radius:14px;padding:18px;box-shadow:0 6px 24px rgba(15,42,67,.06)}

    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}

    label{display:block;font-weight:600;margin:14px 0 6px}

    input,select,textarea{width:100%;padding:14px;border:1px solid #dcdfe5;border-radius:12px;font:inherit;background:#fff}

    textarea{min-height:120px;resize:vertical}

    .agree{display:flex;gap:10px;margin-top:14px}

    .actions{display:flex;gap:10px;margin-top:18px}

    .btn{padding:14px 18px;border-radius:12px;border:1px solid #dcdfe5;background:#f8f9fb}

    .btn-gold{background:var(--gold);border-color:var(--gold-700);color:#111;font-weight:700}

    .alert{margin-top:16px;border-radius:12px;padding:14px;border:1px solid #f2c8c8;background:#fdeeee;color:#9a1c1c;white-space:pre-wrap}

    .hidden{display:none}

  </style>

</head>

<body>

  <div class="container">

    <h1>ProBuildZone â€” Start Free Trial</h1>

    <div class="card">

      <form id="prosForm" novalidate>

        <div class="row">

          <div>

            <label for="name">Business / Owner name</label>

            <input id="name" name="name" required>

          </div>

          <div>

            <label for="email">Email</label>

            <input id="email" name="email" type="email" required>

          </div>

        </div>

        <div class="row">

          <div>

            <label for="phone">Phone</label>

            <input id="phone" name="phone" required>

          </div>

          <div>

            <label for="address">Business address</label>

            <input id="address" name="address">

          </div>

        </div>

        <div class="row">

          <div>

            <label for="license">Business license / #</label>

            <input id="license" name="license" required>

          </div>

          <div>

            <label for="insurance">Insurance (Optional)</label>

            <select id="insurance" name="insurance">

              <option value="">â€” Select â€”</option>

              <option>General Liability</option>

              <option>Workersâ€™ Compensation</option>

              <option>Bonded</option>

            </select>

          </div>

        </div>

        <div class="row">

          <div style="grid-column:1/-1">

            <label for="notes">Services & notes (optional)</label>

            <textarea id="notes" name="notes"></textarea>

          </div>

        </div>

        <div class="agree">

          <input id="agree" type="checkbox" checked required>

          <label for="agree">By starting your free trial, you agree to our

            <a href="/terms.html" target="_blank">Terms</a> & <a href="/privacy.html" target="_blank">Privacy</a>.

          </label>

        </div>

        <div id="alert" class="alert hidden"></div>

        <div class="actions">

          <button type="reset" class="btn">Reset</button>

          <button id="startBtn" type="button" class="btn btn-gold">Start Free Trial</button>

        </div>

      </form>

    </div>

  </div>



  <script>

    const $ = s => document.querySelector(s);

    const alertBox = $('#alert');

    const startBtn = $('#startBtn');

    const NETLIFY_BASE = location.hostname.endsWith('netlify.app') ? '' : 'https://probuildzone.netlify.app';



    function showError(msg){

      alertBox.textContent = msg;

      alertBox.classList.remove('hidden');

    }

    function clearError(){

      alertBox.textContent = '';

      alertBox.classList.add('hidden');

    }



    async function startTrial(){

      clearError();

      const payload = {

        name: $('#name').value.trim(),

        email: $('#email').value.trim(),

        phone: $('#phone').value.trim(),

        address: $('#address').value.trim(),

        license: $('#license').value.trim(),

        insurance: $('#insurance').value,

        notes: $('#notes').value.trim(),

      };



      if(!payload.name || !payload.email || !payload.phone || !payload.license){

        showError('Please fill name, email, phone, and license.');

        return;

      }



      // ðŸ‘‡ Ù…Ù‡Ù…: Ù†Ø®Ø²Ù‘Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø´Ø§Ù† success.html ØªÙ‚Ø¯Ø± ØªØ¨Ø¹Ø«Ù‡Ø§

      localStorage.setItem('pbz_form_data', JSON.stringify(payload));



      startBtn.disabled = true;

      startBtn.textContent = 'Creating session...';



      try {

        const res = await fetch(`${NETLIFY_BASE}/.netlify/functions/create-checkout-session`, {

          method: 'POST',

          headers: { 'Content-Type': 'application/json' },

          body: JSON.stringify(payload)

        });



        const data = await res.json();

        if (res.ok && data.url) {

          window.location.href = data.url;

        } else {

          showError('Could not start checkout.');

        }

      } catch (err) {

        showError(err.message);

      } finally {

        startBtn.disabled = false;

        startBtn.textContent = 'Start Free Trial';

      }

    }



    startBtn.addEventListener('click', e => { e.preventDefault(); startTrial(); });

  </script>

</body>

</html>
