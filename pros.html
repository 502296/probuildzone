<!doctype html>

<html lang="en">

<head>

  <meta charset="utf-8"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <title>ProBuildZone – For Pros</title>

  <style>

    body{margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:#0f2a43;color:#fff}

    .container{max-width:980px;margin:0 auto;padding:24px}

    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}

    .brand{font-weight:800;letter-spacing:.3px}

    .hero{display:grid;gap:14px;margin:28px 0}

    .card{background:#0b1f31;border:1px solid #1b3e60;border-radius:14px;padding:20px}

    .btn{padding:12px 18px;border:1px solid #365b7a;border-radius:10px;background:#0b1f31;color:#fff;cursor:pointer}

    .btn-primary{background:#F28C1B;border-color:#F28C1B;color:#0f2a43;font-weight:800}

    .btn[disabled]{opacity:.6;cursor:not-allowed}

    /* Modal */

    .modal[hidden]{display:none}

    .modal{position:fixed;inset:0;display:grid;place-items:center;background:#0008;z-index:9999}

    .modal-card{background:#0f2a43;color:#fff;padding:24px;border-radius:12px;min-width:320px;max-width:520px;border:1px solid #1b3e60}

    .grid{display:grid;gap:12px;margin:12px 0}

    label{display:grid;gap:6px;font-size:.95rem}

    input{padding:10px;border:1px solid #365b7a;border-radius:8px;background:#0b1f31;color:#fff}

    .actions{display:flex;gap:10px;justify-content:flex-end;margin-top:8px}

    .msg{margin-top:10px;font-size:.9rem}

  </style>

</head>

<body>

  <div class="container">

    <header>

      <div class="brand">ProBuildZone</div>

      <nav><a href="/" class="btn">Home</a></nav>

    </header>



    <section class="hero">

      <div class="card">

        <h1>Grow your business with ProBuildZone</h1>

        <p>Start your <strong>30-day free trial</strong>. Annual plan – cancel anytime before trial ends.</p>

        <button id="startTrialBtn" class="btn btn-primary" type="button">Start Free Trial</button>

      </div>

    </section>

  </div>



  <!-- Signup Modal -->

  <div id="trialModal" class="modal" hidden>

    <div class="modal-card">

      <h3>Start your 30-day free trial</h3>

      <form id="trialForm">

        <div class="grid">

          <label>Company Name<input name="company" required placeholder="e.g., Royal Builders LLC"></label>

          <label>Full Name<input name="name" required placeholder="Your name"></label>

          <label>Email<input type="email" name="email" required placeholder="name@company.com"></label>

          <label>Phone<input name="phone" required placeholder="+1 (502) 555-1234"></label>

          <label>Address<input name="address" required placeholder="Street, City, State"></label>

        </div>

        <div class="actions">

          <button type="button" id="cancelTrial" class="btn">Cancel</button>

          <button type="submit" id="submitTrial" class="btn btn-primary">Continue</button>

        </div>

        <p id="trialMsg" class="msg" aria-live="polite"></p>

      </form>

    </div>

  </div>



  <script type="module">

    const $ = (s, p=document) => p.querySelector(s);

    const openModal = ()=> { $("#trialModal").hidden = false; };

    const closeModal = ()=> { $("#trialModal").hidden = true; };

    const serializeForm = (form)=>{

      const data = new FormData(form);

      return Object.fromEntries([...data.entries()].map(([k,v])=>[k, v.trim()]));

    };

    const postJSON = async (url, payload)=>{

      const res = await fetch(url, {

        method: "POST",

        headers: {"Content-Type": "application/json"},

        body: JSON.stringify(payload)

      });

      if(!res.ok){

        const text = await res.text().catch(()=> "");

        throw new Error(text || `Request failed: ${res.status}`);

      }

      return res.json();

    };

    const setLoading = (b)=>{

      $("#submitTrial").disabled = b;

      $("#startTrialBtn")?.setAttribute("aria-busy", b ? "true" : "false");

    };



    // Handlers

    $("#startTrialBtn")?.addEventListener("click", () => {

      openModal();

      $("#trialMsg").textContent = "";

    });

    $("#cancelTrial")?.addEventListener("click", () => closeModal());

    $("#trialModal")?.addEventListener("click",(e)=>{ if(e.target.id === "trialModal") closeModal(); });



    $("#trialForm")?.addEventListener("submit", async (e) => {

      e.preventDefault();

      $("#trialMsg").textContent = "";

      setLoading(true);

      try{

        const payload = serializeForm(e.currentTarget);

        // اختياري: حفظ مبدئي

        // await postJSON("/api/pros/create", payload);



        // Stripe checkout session

        const { checkoutUrl } = await postJSON("/api/stripe/create-checkout-session", payload);

        window.location.href = checkoutUrl;

      }catch(err){

        console.error(err);

        $("#trialMsg").textContent = "Something went wrong. Please try again.";

      }finally{

        setLoading(false);

      }

    });

  </script>

</body>

</html>
