<!doctype html>

<html lang="en">

<head>

<meta charset="utf-8"/>

<meta name="viewport" content="width=device-width, initial-scale=1"/>

<title>ProBuildZone — Start Free Trial</title>

<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>

  :root{

    --pbz-blue:#0F2A43; --pbz-blue-2:#0b2033;

    --gold:#D4AF37; --gold-700:#b9962f;

    --muted:#6b7a8c; --card:#ffffff; --bg:#f6f7fb; --danger:#b00020;

  }

  *{box-sizing:border-box}

  body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#111;background:var(--bg)}

  .wrap{max-width:880px;margin:32px auto;padding:16px}

  .card{background:var(--card);border:1px solid #e7e7e7;border-radius:14px;padding:22px;box-shadow:0 10px 24px rgba(15,42,67,.08)}

  h1{margin:0 0 8px;color:var(--pbz-blue)}

  .sub{color:var(--muted);margin:0 0 20px}

  .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}

  .grid-1{display:grid;grid-template-columns:1fr;gap:14px}

  label{display:block;font-weight:600;margin:6px 0}

  input,select,textarea{width:100%;padding:12px 14px;border:1px solid #d9d9df;border-radius:10px;font-size:16px;background:#fff;outline:none}

  textarea{min-height:90px;resize:vertical}

  .row{margin-top:6px}

  .hint{font-size:13px;color:var(--muted)}

  .actions{display:flex;gap:12px;align-items:center;margin-top:18px}

  .btn{border:0;padding:12px 18px;border-radius:12px;font-weight:700;cursor:pointer;transition:transform .06s ease,box-shadow .2s ease,background .2s ease}

  .btn.gold{background:linear-gradient(180deg,var(--gold),#e3c257);color:#141414;box-shadow:0 6px 20px rgba(212,175,55,.35)}

  .btn.gold:disabled{background:#e9dfb7;color:#7a6b2a;cursor:not-allowed;box-shadow:none;opacity:.7}

  .btn.gold:active{transform:translateY(1px)}

  .btn.reset{background:#eef2f6;color:#1b2a38}

  .checkline{display:flex;gap:10px;align-items:flex-start;margin-top:6px}

  .checkline input{width:18px;height:18px;margin-top:2px}

  .badge{display:none;margin-top:14px;padding:11px 14px;border-radius:10px;font-weight:600}

  .badge.err{display:block;background:#fde9ec;color:#7d0e21;border:1px solid #f6c7cf}

  .mobile-only{display:none} .desktop-only{display:none}

  @media (max-width:720px){ .grid{grid-template-columns:1fr} }

</style>

</head>

<body>

  <div class="wrap">

    <div class="card">

      <h1>Start your Pro Trial</h1>

      <p class="sub">Join ProBuildZone Pros. Full access to private projects & leads.</p>



      <!-- مهم: لا action ولا method. الإرسال سيتم عبر fetch POST -->

      <form id="proForm" novalidate>

        <div class="grid">

          <div class="row">

            <label for="full_name">Full name</label>

            <input id="full_name" name="full_name" autocomplete="name" required/>

          </div>



          <div class="row">

            <label for="email">Email</label>

            <input id="email" name="email" type="email" autocomplete="email" required/>

          </div>



          <!-- Phone for Pros (مطلوب) -->

          <div class="row">

            <label for="phone">Phone</label>

            <input id="phone" name="phone" type="tel" inputmode="tel" autocomplete="tel"

                   placeholder="(502) 555-0123" required/>

          </div>



          <!-- Website (اختياري لسطح المكتب) -->

          <div class="row desktop-only">

            <label for="website">Company website (desktop)</label>

            <input id="website" name="website" placeholder="https://example.com"/>

            <div class="hint">Shown on desktops only</div>

          </div>



          <div class="row">

            <label for="address">Business address</label>

            <input id="address" name="address" placeholder="Street, City, State"/>

          </div>



          <div class="row">

            <label for="license">Business license / #</label>

            <input id="license" name="license" placeholder="License # / State"/>

          </div>



          <div class="row">

            <label for="insurance">Insurance (Optional)</label>

            <select id="insurance" name="insurance">

              <option value="not_provided" selected>Not provided</option>

              <option value="general_liability">General Liability</option>

              <option value="workers_comp">Workers’ Compensation</option>

              <option value="both">Both</option>

            </select>

          </div>



          <div class="row grid-1">

            <label for="notes">Services & notes (optional)</label>

            <textarea id="notes" name="notes" placeholder="e.g., Decks, Roofing, Remodeling..."></textarea>

          </div>

        </div>



        <div class="checkline">

          <input id="agree" type="checkbox"/>

          <label for="agree">By starting your free trial, you agree to our

            <a href="/terms.html">Terms</a> &amp; <a href="/privacy.html">Privacy</a>.</label>

        </div>



        <div id="err" class="badge err"></div>



        <div class="actions">

          <button type="reset" class="btn reset" id="resetBtn">Reset</button>

          <button type="button" class="btn gold" id="startBtn" disabled>Start Free Trial</button>

        </div>

      </form>



      <p class="hint" style="margin-top:18px">© 2025 ProBuildZone — Fair Prices • Local Pros</p>

    </div>

  </div>



<script>

(function(){

  // إظهار/إخفاء عناصر حسب الجهاز

  const isMobile = /iPhone|Android.+Mobile|iPad|iPod/i.test(navigator.userAgent);

  document.querySelectorAll('.desktop-only').forEach(el => el.style.display = isMobile ? 'none' : '');



  const $ = (s)=>document.querySelector(s);

  const form = $('#proForm'), agree = $('#agree'), startBtn = $('#startBtn'), errBox = $('#err');



  function canSubmit(){

    const name = $('#full_name').value.trim();

    const email = $('#email').value.trim();

    const phone = $('#phone').value.trim();

    const emailOK = /\S+@\S+\.\S+/.test(email);

    return agree.checked && name.length >= 2 && emailOK && phone.length >= 6;

  }

  function updateBtn(){ startBtn.disabled = !canSubmit(); }

  form.addEventListener('input', updateBtn);

  agree.addEventListener('change', updateBtn);



  async function startSubscription(){

    errBox.style.display = 'none';

    if(!canSubmit()){

      errBox.textContent = 'Please fill name, valid email & phone and agree to Terms.';

      errBox.style.display = 'block';

      return;

    }



    const payload = {

      name:   $('#full_name').value.trim(),

      email:  $('#email').value.trim(),

      phone:  $('#phone').value.trim(),

      website:($('#website')?.value || '').trim(),

      address:($('#address')?.value || '').trim(),

      license:($('#license')?.value || '').trim(),

      insurance:($('#insurance')?.value || 'not_provided'),

      notes:  ($('#notes')?.value || '').trim(),

      source: 'pros.html'

    };



    const original = startBtn.textContent;

    startBtn.disabled = true; startBtn.textContent = 'Processing…';



    try{

      const res = await fetch('/.netlify/functions/create-checkout-session', {

        method:'POST',

        headers:{'Content-Type':'application/json'},

        body: JSON.stringify(payload)

      });



      if(!res.ok){

        const text = await res.text();

        throw new Error(text || ('HTTP '+res.status));

      }



      const data = await res.json();   // { url: "https://checkout.stripe.com/..." }

      if(data && data.url) window.location.href = data.url;

      else throw new Error('No checkout URL returned.');

    }catch(e){

      errBox.textContent = 'Failed to fetch session: ' + (e.message || e);

      errBox.style.display = 'block';

      startBtn.disabled = false; startBtn.textContent = original;

    }

  }



  $('#startBtn').addEventListener('click', startSubscription);

  $('#resetBtn').addEventListener('click', ()=>{ form.reset(); updateBtn(); errBox.style.display='none'; });



  updateBtn(); // حالة أولية

})();

</script>

</body>

</html>
