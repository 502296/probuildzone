<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>ProBuildZone ‚Äî Homeowner</title>



  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">



  <style>

    :root{

      --blue:#0f2a43;

      --blue-700:#143756;

      --bg:#f6f7fb;

      --card:#ffffff;

      --ok:#0a8a5b;

      --err:#b00020;

    }

    *{box-sizing:border-box}

    body{

      font-family:"Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;

      background:var(--bg);

      color:var(--blue);

      padding:40px 16px;

    }

    h1{ text-align:center; margin:0 0 18px }

    p.sub{ text-align:center; margin:0 0 26px; color:#516171 }



    form{

      max-width:560px; margin:0 auto; background:var(--card);

      padding:24px; border-radius:12px; box-shadow:0 8px 30px rgba(10,20,40,.06);

    }

    label{ display:block; font-weight:600; margin:12px 0 6px }

    input, textarea{

      width:100%; padding:12px 14px; border:1px solid #d7dbe3; border-radius:10px;

      font-size:1rem; background:#fff; outline:none; transition:border-color .15s ease;

    }

    input:focus, textarea:focus{ border-color:#9fb7cc }

    textarea{ resize:vertical; min-height:110px }



    button{

      width:100%; margin-top:14px; background:var(--blue); color:#fff;

      font-weight:700; padding:13px 16px; border:0; border-radius:10px; cursor:pointer;

      transition:transform .06s ease, background .15s ease; letter-spacing:.2px;

    }

    button:hover{ background:var(--blue-700) }

    button:disabled{ opacity:.65; cursor:not-allowed }



    .msg{

      text-align:center; margin-top:12px; font-weight:600;

    }

    .msg.ok{ color:var(--ok) }

    .msg.err{ color:var(--err) }



    .hint{ font-size:.85rem; color:#6b7a8c; margin-top:6px }

  </style>

</head>

<body>

  <h1>üè° Post Your Project</h1>

  <p class="sub">Tell us about your project and local pros will send offers.</p>



  <form id="job-form" novalidate>

    <label for="name">Full Name *</label>

    <input id="name" type="text" placeholder="e.g., Ali Kathem" required />



    <label for="email">Email Address *</label>

    <input id="email" type="email" placeholder="name@example.com" required />



    <label for="phone">Phone Number (optional)</label>

    <input id="phone" type="tel" inputmode="tel" placeholder="e.g., 502-555-0137" />



    <label for="address">Project Address *</label>

    <input id="address" type="text" placeholder="Street, City, State" required />



    <label for="description">Project Description *</label>

    <textarea id="description" placeholder="Describe the work (materials, size, timeline)‚Ä¶" required></textarea>



    <button id="submitBtn" type="submit">üöÄ Post Job</button>



    <div id="post-ok" class="msg ok" style="display:none;"></div>

    <div id="post-error" class="msg err" style="display:none;"></div>

    <div class="hint">By posting, you agree to be contacted by ProBuildZone and matched pros.</div>

  </form>



  <script>

  const form = document.getElementById('job-form');

  const btn  = document.getElementById('submitBtn');

  const okEl = document.getElementById('post-ok');

  const errEl= document.getElementById('post-error');



  form.addEventListener('submit', async (e) => {

    e.preventDefault();



    // basic front-end validation

    const name = document.getElementById('name').value.trim();

    const email= document.getElementById('email').value.trim();

    const phone= document.getElementById('phone')?.value?.trim() || null;

    const address = document.getElementById('address').value.trim();

    const description = document.getElementById('description').value.trim();



    if (!name || !email || !address || !description) {

      showError('Please fill in all required fields.');

      return;

    }



    const payload = { name, email, phone, address, description };



    try {

      okEl.style.display = 'none';

      errEl.style.display = 'none';

      btn.disabled = true; btn.textContent = 'Posting‚Ä¶';



      // ‚úÖ Netlify Function endpoint

      const res = await fetch('/.netlify/functions/post-job', {

        method: 'POST',

        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },

        body: JSON.stringify(payload),

      });



      const text = await res.text();

      let data;

      try { data = JSON.parse(text); }

      catch { throw new Error(`Non-JSON response (${res.status}): ${text.slice(0,120)}‚Ä¶`); }



      if (!res.ok) throw new Error(data.error || 'Failed to post job');



      // try to show returned job id if provided by the function

      const jid = data.jobId || data.id || data.reference || null;

      showOk(`‚úÖ Job posted successfully${jid ? ` ‚Äî ID: ${jid}` : '!'}`);

      form.reset();

    } catch (err) {

      showError(err.message);

      console.error(err);

    } finally {

      btn.disabled = false; btn.textContent = 'üöÄ Post Job';

    }

  });



  function showOk(msg){

    okEl.textContent = msg;

    okEl.style.display = 'block';

    errEl.style.display = 'none';

  }

  function showError(msg){

    errEl.textContent = `Error: ${msg}`;

    errEl.style.display = 'block';

    okEl.style.display = 'none';

  }

  </script>

</body>

</html>
