<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>ProBuildZone ‚Äî Homeowner</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <style>

    body {

      font-family: "Inter", sans-serif;

      background: #f6f7fb;

      color: #0f2a43;

      padding: 40px;

    }

    h1 { text-align: center; color: #0f2a43; }

    form {

      max-width: 500px;

      margin: 40px auto;

      background: white;

      padding: 25px;

      border-radius: 10px;

      box-shadow: 0 2px 8px rgba(0,0,0,0.1);

    }

    input, textarea {

      width: 100%;

      padding: 10px;

      margin: 10px 0;

      border: 1px solid #ccc;

      border-radius: 6px;

      font-size: 1rem;

    }

    button {

      width: 100%;

      background-color: #0f2a43;

      color: white;

      font-weight: 600;

      padding: 12px;

      border: none;

      border-radius: 6px;

      cursor: pointer;

      transition: 0.2s;

    }

    button:hover {

      background-color: #143756;

    }

    #post-error {

      color: red;

      text-align: center;

      font-weight: 500;

      margin-top: 10px;

    }

  </style>

</head>

<body>

  <h1>üè° Post Your Project</h1>



  <form id="job-form">

    <input id="name" type="text" placeholder="Full Name" required />

    <input id="email" type="email" placeholder="Email Address" required />

    <input id="phone" type="text" placeholder="Phone Number (optional)" />

    <input id="address" type="text" placeholder="Project Address" required />

    <textarea id="description" rows="4" placeholder="Describe your project" required></textarea>

    <button type="submit">üìã Post Job</button>

    <p id="post-error"></p>

  </form>



  <script>

  document.getElementById('job-form').addEventListener('submit', async (e) => {

    e.preventDefault();



    const payload = {

      name: document.getElementById('name').value.trim(),

      email: document.getElementById('email').value.trim(),

      phone: document.getElementById('phone')?.value?.trim() || null,

      address: document.getElementById('address').value.trim(),

      description: document.getElementById('description').value.trim(),

    };



    try {

      const res = await fetch('/.netlify/functions/post-job', {

        method: 'POST',

        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },

        body: JSON.stringify(payload),

      });



      const text = await res.text();

      let data;

      try { data = JSON.parse(text); }

      catch {

        throw new Error(`Non-JSON response (${res.status}): ${text.slice(0,120)}‚Ä¶`);

      }



      if (!res.ok) throw new Error(data.error || 'Failed to post job');



      alert('‚úÖ Job posted successfully!');

      e.target.reset();

    } catch (err) {

      console.error(err);

      const msg = document.getElementById('post-error');

      if (msg) msg.textContent = `Error: ${err.message}`;

      else alert(`Error: ${err.message}`);

    }

  });

  </script>

</body>

</html>
