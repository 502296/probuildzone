<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>ProBuildZone – Homeowner</title>

  <style>

    :root {

      --bg: #f5f6fa;

      --card: #ffffff;

      --primary: #0F2A43;

      --primary-dark: #0b1f33;

      --danger: #c0392b;

      --success: #27ae60;

      --radius: 12px;

    }

    body {

      background: var(--bg);

      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;

      padding: 30px 15px 50px;

      display: flex;

      justify-content: center;

    }

    .container {

      width: min(520px, 100%);

    }

    h1 {

      text-align: center;

      color: var(--primary);

      margin-bottom: 10px;

    }

    p.sub {

      text-align: center;

      color: #666;

      margin-bottom: 25px;

      font-size: 0.95rem;

    }

    form {

      background: var(--card);

      padding: 22px 25px 26px;

      border-radius: var(--radius);

      box-shadow: 0 0 12px rgba(0,0,0,0.06);

    }

    label {

      display: block;

      margin-top: 14px;

      font-weight: 600;

    }

    input, textarea, select {

      width: 100%;

      margin-top: 6px;

      padding: 10px 11px;

      border-radius: 6px;

      border: 1px solid #dcdde1;

      font-size: 0.93rem;

      transition: border 0.15s ease;

      background: #fff;

    }

    input:focus, textarea:focus, select:focus {

      outline: none;

      border: 1px solid rgba(15, 42, 67, 0.65);

      box-shadow: 0 0 0 2px rgba(15,42,67,0.08);

    }

    textarea {

      min-height: 90px;

      resize: vertical;

    }

    button {

      width: 100%;

      margin-top: 22px;

      background: var(--primary);

      color: white;

      border: none;

      border-radius: 6px;

      padding: 12px 0;

      font-size: 1rem;

      cursor: pointer;

      display: inline-flex;

      align-items: center;

      justify-content: center;

      gap: 8px;

      transition: background 0.15s ease;

    }

    button[disabled] {

      background: #95a5a6;

      cursor: not-allowed;

    }

    button:hover:not([disabled]) {

      background: var(--primary-dark);

    }

    .msg {

      margin-top: 15px;

      padding: 10px 12px;

      border-radius: 6px;

      display: none;

      font-size: 0.9rem;

    }

    .msg.success {

      background: rgba(39, 174, 96, 0.12);

      color: var(--success);

    }

    .msg.error {

      background: rgba(192, 57, 43, 0.11);

      color: var(--danger);

      white-space: pre-wrap;

    }

    .small {

      font-size: 0.77rem;

      color: #888;

      margin-top: 3px;

    }

    .spinner {

      width: 16px;

      height: 16px;

      border: 2px solid rgba(255,255,255,0.4);

      border-top-color: #fff;

      border-radius: 50%;

      animation: spin 0.7s linear infinite;

    }

    @keyframes spin {

      to { transform: rotate(360deg); }

    }

  </style>

</head>

<body>

  <div class="container">

    <h1>Post your project</h1>

    <p class="sub">Tell us what you need and we’ll match you with local pros.</p>



    <form id="homeownerForm">

      <label for="full_name">Full name *</label>

      <input id="full_name" name="full_name" required />



      <label for="phone">Phone *</label>

      <input id="phone" name="phone" required />



      <label for="address">Full address *</label>

      <input id="address" name="address" required />



      <label for="title">Project title *</label>

      <input id="title" name="title" placeholder="Fix leaking sink, kitchen remodel..." required />



      <label for="description">Full description *</label>

      <textarea id="description" name="description" placeholder="Describe the issue, when you want it done, photos link, etc." required></textarea>



      <label for="category">Category (optional)</label>

      <select id="category" name="category">

        <option value="">-- Select --</option>

        <option>Plumbing</option>

        <option>Electrical</option>

        <option>Landscaping</option>

        <option>Painting</option>

        <option>Porch</option>

        <option>Roofing</option>

      </select>



      <p class="small">* required</p>



      <button type="submit" id="submitBtn">

        <span id="btnText">Submit</span>

      </button>



      <div id="successMsg" class="msg success">✅ Your request was sent!</div>

      <div id="errorMsg" class="msg error">❌ Something went wrong.</div>

    </form>

  </div>



  <script>

    const form = document.getElementById('homeownerForm');

    const submitBtn = document.getElementById('submitBtn');

    const successMsg = document.getElementById('successMsg');

    const errorMsg = document.getElementById('errorMsg');



    function setLoading(isLoading) {

      if (isLoading) {

        submitBtn.setAttribute('disabled', 'true');

        submitBtn.innerHTML = '';

        const sp = document.createElement('div');

        sp.className = 'spinner';

        submitBtn.appendChild(sp);

      } else {

        submitBtn.removeAttribute('disabled');

        submitBtn.innerHTML = '<span id="btnText">Submit</span>';

      }

    }



    form.addEventListener('submit', async (e) => {

      e.preventDefault();

      successMsg.style.display = 'none';

      errorMsg.style.display = 'none';



      const payload = {

        full_name: document.getElementById('full_name').value.trim(),

        phone: document.getElementById('phone').value.trim(),

        address: document.getElementById('address').value.trim(),

        title: document.getElementById('title').value.trim(),

        description: document.getElementById('description').value.trim(),

        category: document.getElementById('category').value.trim(),

      };



      // validation بسيط

      if (!payload.full_name || !payload.phone || !payload.address || !payload.title || !payload.description) {

        errorMsg.textContent = '❌ Please fill all required fields.';

        errorMsg.style.display = 'block';

        return;

      }



      setLoading(true);



      try {

        const res = await fetch('/.netlify/functions/post-homeowner', {

          method: 'POST',

          headers: { 'Content-Type': 'application/json' },

          body: JSON.stringify(payload),

        });



        const data = await res.json();



        if (res.ok && data.ok) {

          successMsg.style.display = 'block';

          form.reset();

        } else {

          errorMsg.textContent = '❌ ' + (data.error || 'Server error');

          errorMsg.style.display = 'block';

        }

      } catch (err) {

        errorMsg.textContent = '❌ Network error: ' + err.message;

        errorMsg.style.display = 'block';

      } finally {

        setLoading(false);

      }

    });

  </script>

</body>

</html>
