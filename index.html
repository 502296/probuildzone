<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width,initial-scale=1.0" />

  <title>ProBuildZone ‚Äî Get Home Projects Done</title>

  <meta name="description" content="Post your project with photos. Local contractors send offers. You choose the best match ‚Äî fair prices, local pros." />

  <link rel="stylesheet" href="style.css" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <!-- ÿ™ÿπÿ≤Ÿäÿ≤ Ÿàÿ∂Ÿàÿ≠ ÿßŸÑÿ≤ÿ± ÿπŸÑŸâ ÿßŸÑŸÖŸàÿ®ÿßŸäŸÑ (ŸÑÿß Ÿäÿ∫ŸäŸëÿ± ÿ™ÿµŸÖŸäŸÖŸÉ ÿßŸÑÿπÿßŸÖ) -->

  <style>

    .sheet{max-height:90vh;overflow:auto;padding-bottom:120px;}

    .sticky-submit{

      position:sticky; bottom:0; background:rgba(255,255,255,.95);

      backdrop-filter:saturate(140%) blur(4px); padding:12px; border-top:1px solid #e6ebf2;

      box-shadow:0 -6px 20px rgba(0,0,0,.06); display:grid; gap:8px;

    }

    .sticky-submit .hint{display:block;font-size:.95rem;}

    @media (max-width:640px){ .sticky-submit{padding:12px 10px;} }

  </style>

</head>



<body>

  <header>

    <nav class="topnav">

      <div class="brand-logo"><span class="pro">Pro</span><span class="build">Build</span><span class="zone">Zone</span></div>

      <div class="nav-actions">

        <a href="pros.html" class="pro-btn">For Pros</a>

        <div class="menu-wrap">

          <button id="menuBtn" class="menu-btn">Menu ‚ñæ</button>

          <div class="menu-panel" id="menuPanel">

            <a href="#" id="openAboutFromMenu">Services</a>

            <a href="privacy.html">Privacy</a>

            <a href="terms.html">Terms</a>

          </div>

        </div>

      </div>

    </nav>

  </header>



  <section class="hero" id="home">

    <div class="hero-bg"></div>

    <div class="overlay">

      <h1>Get Home Projects Done ‚Äî Fair Prices, Local Pros.</h1>

      <p>Post your project with photos. Local contractors send offers. You choose the best match.</p>

      <div class="buttons">

        <button class="btn primary" id="postJobTop">Post a Job (Free)</button>

      </div>



      <!-- Quick Job ID box -->

      <div class="job-id">

        <input id="jobIdQuick" type="text" placeholder="Enter Job ID (e.g., PBZ-12345)" />

        <button id="goQuick">Go</button>

      </div>

    </div>

  </section>



  <!-- About modal -->

  <div class="about-modal" id="aboutModal" style="display:none">

    <div class="about-dialog">

      <div class="about-head">

        <h3>About our platform</h3>

        <button class="btn xsm ghost" id="aboutClose">Close</button>

      </div>

      <div class="about-body">

        <p><strong>ProBuildZone</strong> connects homeowners with local pros. We do not perform construction work and we do not handle payments.</p>

        <ul>

          <li>Local, relevant pros.</li>

          <li>Privacy-first access.</li>

          <li>Direct negotiation.</li>

          <li>No platform interference.</li>

        </ul>

      </div>

    </div>

  </div>



  <!-- Post job modal -->

  <div class="modal" id="modal" style="display:none">

    <div class="sheet">

      <div class="sheet-head">

        <button class="btn xsm ghost back" id="backBtn">‚Üê Back</button>

        <h3 id="sheetTitle">Post a Job</h3>

        <button class="btn xsm ghost" id="closeDoor">Close</button>

      </div>



      <!-- Step 1 -->

      <section class="job-form" id="step1">

        <h2>Choose a category</h2>

        <p class="note">Pick the closest category, you can adjust later.</p>

        <div class="cat-grid">

          <button class="cat-card" data-cat="Roofing">üè†<span>Roofing</span></button>

          <button class="cat-card" data-cat="Decks & Porches">ü™ö<span>Decks & Porches</span></button>

          <button class="cat-card" data-cat="Kitchens">üç≥<span>Kitchens</span></button>

          <button class="cat-card" data-cat="Bathrooms">üõÅ<span>Bathrooms</span></button>

          <button class="cat-card" data-cat="Flooring">ü™µ<span>Flooring</span></button>

          <button class="cat-card" data-cat="Painting">üé®<span>Painting</span></button>

          <button class="cat-card" data-cat="Masonry">üß±<span>Masonry</span></button>

          <button class="cat-card" data-cat="Electrical">‚ö°<span>Electrical</span></button>

          <button class="cat-card" data-cat="Plumbing">üö∞<span>Plumbing</span></button>

          <button class="cat-card" data-cat="Windows & Doors">ü™ü<span>Windows & Doors</span></button>

          <button class="cat-card" data-cat="Landscaping">üåø<span>Landscaping</span></button>

          <button class="cat-card" data-cat="Handyman">üß∞<span>Handyman</span></button>

        </div>

      </section>



      <!-- Step 2 -->

      <section class="job-form" id="step2" style="display:none">

        <div class="selected-cat" id="selectedCat">Category: <b>-</b></div>



        <div class="upload-wrap" id="dropZone">

          <input type="file" id="fileInput" multiple accept="image/*,application/pdf" style="display:none" />

          <button type="button" class="btn outline" id="pickBtn">

            <i class="fa-solid fa-cloud-arrow-up"></i> Choose Photos/Files

          </button>

          <span class="hint">You can upload multiple images or a PDF.</span>

        </div>

        <div class="file-hint">Adding files helps pros estimate faster.</div>

        <div class="card" id="fileList"></div>



        <input type="hidden" id="categoryHidden" value="General" />



        <label for="title">Project title *</label>

        <input id="title" type="text" placeholder="e.g., Replace leaking roof" required />



        <label for="summary">Short summary</label>

        <input id="summary" type="text" placeholder="One or two lines..." />



        <div class="row2">

          <div>

            <label for="city">City</label>

            <input id="city" type="text" placeholder="Enter city" />

          </div>

          <div>

            <label for="state">State</label>

            <input id="state" type="text" placeholder="Enter state" />

          </div>

        </div>



        <div class="row2">

          <div>

            <label for="contactName">Contact name *</label>

            <input id="contactName" type="text" placeholder="Your name" required />

          </div>

          <div>

            <label for="phone">Phone *</label>

            <input id="phone" type="tel" placeholder="Your phone number" required />

          </div>

        </div>



        <label for="email">Email *</label>

        <input id="email" type="email" placeholder="you@example.com" required />



        <label for="address">Full address *</label>

        <input id="address" type="text" placeholder="Street, City, State" required />



        <label for="longDesc">Full description *</label>

        <textarea id="longDesc" rows="4" placeholder="Describe the job in detail..." required></textarea>



        <div class="sticky-submit">

          <button id="sendBtn" class="btn primary">üöÄ Post Job</button>

          <span id="sendMsg" class="hint"></span>

        </div>

      </section>

    </div>

  </div>



  <script>

    // ===== NAV MENU =====

    const menuBtn=document.getElementById("menuBtn");

    const menuPanel=document.getElementById("menuPanel");

    if(menuBtn) menuBtn.addEventListener("click",()=>{

      menuPanel.style.display=menuPanel.style.display==="block"?"none":"block";

    });

    document.addEventListener("click",(e)=>{

      if(!e.target.closest(".menu-wrap")) menuPanel && (menuPanel.style.display="none");

    });



    // ===== ABOUT =====

    const aboutModal=document.getElementById("aboutModal");

    const openAbout=(e)=>{ if(e) e.preventDefault(); aboutModal.style.display="grid"; document.documentElement.style.overflow="hidden"; };

    const closeAbout=()=>{ aboutModal.style.display="none"; document.documentElement.style.overflow=""; };

    document.getElementById("openAboutFromMenu")?.addEventListener("click",(e)=>{

      e.preventDefault(); openAbout(); menuPanel && (menuPanel.style.display="none");

    });

    document.getElementById("aboutClose")?.addEventListener("click",closeAbout);

    aboutModal?.addEventListener("click",(ev)=>{ if(ev.target===aboutModal) closeAbout(); });



    // ===== MODAL =====

    const modal=document.getElementById("modal");

    const step1=document.getElementById("step1");

    const step2=document.getElementById("step2");

    const sheet=document.querySelector(".sheet");

    const selectedCatEl=document.getElementById("selectedCat").querySelector("b");

    const hiddenCat=document.getElementById("categoryHidden");



    function openDoor(){ modal.style.display="flex"; document.documentElement.style.overflow="hidden"; goStep(1); }

    function closeDoor(){ modal.style.display="none"; document.documentElement.style.overflow=""; }

    function goStep(n){

      if(n===1){

        step1.style.display="block";

        step2.style.display="none";

        document.getElementById("sheetTitle").textContent="Post a Job";

      } else {

        step1.style.display="none";

        step2.style.display="block";

        document.getElementById("sheetTitle").textContent="Post a Job";

        sheet.scrollTop=0;

      }

    }



    document.getElementById("postJobTop").addEventListener("click",openDoor);

    document.getElementById("closeDoor").addEventListener("click",closeDoor);

    document.getElementById("backBtn").addEventListener("click",()=>{

      if(step1.style.display==="block") closeDoor(); else goStep(1);

    });



    document.querySelectorAll(".cat-card").forEach((btn)=>{

      btn.addEventListener("click",()=>{

        const val=btn.dataset.cat;

        hiddenCat.value=val;

        selectedCatEl.textContent=val;

        goStep(2);

      });

    });



    // ===== QUICK JOB ID ‚Üí job.html =====

    document.getElementById("goQuick").addEventListener("click",()=>{

      const id=document.getElementById("jobIdQuick").value.trim();

      if(!id) return;

      // ŸÜÿ±ÿ≥ŸÑ ÿßŸÑÿ≤ÿ®ŸàŸÜ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÑÿµŸÅÿ≠ÿ© Job Details ÿßŸÑÿ¨ÿØŸäÿØÿ©

      window.location.href="/job.html?id="+encodeURIComponent(id);

    });



    // ===== FILES PREVIEW (UI only) =====

    const fileInput=document.getElementById("fileInput");

    const pickBtn=document.getElementById("pickBtn");

    const fileList=document.getElementById("fileList");

    const dropZone=document.getElementById("dropZone");



    if(pickBtn) pickBtn.onclick=()=>fileInput.click();



    const humanSize=(b)=> b<1024? b+' B' : b<1048576? (b/1024).toFixed(1)+' KB' : (b/1048576).toFixed(1)+' MB';



    const renderList=(files)=>{

      fileList.innerHTML="";

      if(!files.length){

        fileList.innerHTML='<span class="hint">No files selected yet.</span>';

        return;

      }

      [...files].forEach((f)=>{

        const isImg=/^image\//.test(f.type);

        const item=document.createElement("div");

        item.className="file-item";

        item.innerHTML=

          `<div class="thumb">${

            isImg ? `<img src="${URL.createObjectURL(f)}" alt="">`

                  : `<i class="fa-regular fa-file-lines"></i>`

          }</div>

           <div class="meta">

             <b>${f.name}</b>

             <span>${f.type||"file"} ‚Ä¢ ${humanSize(f.size)}</span>

           </div>`;

        fileList.appendChild(item);

      });

    };



    fileInput?.addEventListener("change",()=>renderList(fileInput.files));



    ["dragenter","dragover","dragleave","drop"].forEach((e)=>dropZone?.addEventListener(e,(ev)=>{

      ev.preventDefault(); ev.stopPropagation();

    },false));



    ["dragenter","dragover"].forEach((e)=>dropZone?.addEventListener(e,()=>dropZone.classList.add("hover"),false));

    ["dragleave","drop"].forEach((e)=>dropZone?.addEventListener(e,()=>dropZone.classList.remove("hover"),false));



    dropZone?.addEventListener("drop",(ev)=>{

      const dt=ev.dataTransfer;

      if(dt?.files){

        fileInput.files=dt.files;

        renderList(fileInput.files);

      }

    });



    // ===== SEND ‚Üí post-job (Netlify) =====

    document.getElementById("sendBtn").addEventListener("click", async ()=>{

      const m=document.getElementById("sendMsg");

      const payload={

        category:    document.getElementById("categoryHidden").value || "General",

        title:       document.getElementById("title").value.trim(),

        summary:     document.getElementById("summary").value.trim(),

        city:        document.getElementById("city").value.trim(),

        state:       document.getElementById("state").value.trim(),

        name:        document.getElementById("contactName").value.trim(),

        phone:       document.getElementById("phone").value.trim(),

        email:       document.getElementById("email").value.trim(),

        address:     document.getElementById("address").value.trim(),

        description: document.getElementById("longDesc").value.trim()

        // ŸÑÿß ŸÜÿ±ÿ≥ŸÑ files ÿßŸÑÿ¢ŸÜ

      };



      if(!payload.title||!payload.name||!payload.phone||!payload.email||!payload.address||!payload.description){

        m.textContent="Please fill all required fields.";

        m.className="hint err";

        return;

      }



      m.textContent="Saving to database‚Ä¶";

      m.className="hint";



      try{

        const res=await fetch("/.netlify/functions/post-job",{

          method:"POST",

          headers:{

            "Content-Type":"application/json",

            "Accept":"application/json"

          },

          body:JSON.stringify(payload)

        });



        const text=await res.text();

        let data;

        try{ data=JSON.parse(text);}catch{

          throw new Error(`Non-JSON response (${res.status}): ${text.slice(0,120)}‚Ä¶`);

        }



        if(!res.ok || !data.ok) throw new Error(data.error || `Failed with ${res.status}`);



        const shown=data.public_id || data.job_id || "";

        if(shown){

          m.textContent=`‚úÖ Job posted! Your Job ID: ${shown}`;

          m.className="hint ok";

          const quick=document.getElementById("jobIdQuick");

          if(quick) quick.value=shown;

        }else{

          m.textContent="‚úÖ Job posted!";

          m.className="hint ok";

        }



        setTimeout(()=>{ m.textContent=""; closeDoor(); },1200);

      }catch(e){

        m.textContent="‚ùå Error: "+(e.message||"network error");

        m.className="hint err";

      }

    });

  </script>

</body>

</html>
