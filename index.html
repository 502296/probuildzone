<!DOCTYPE html>

<html lang="en">

<head>

  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <title>ProBuildZone ‚Äî Get Home Projects Done</title>

  <meta name="description" content="Post your project with photos. Local contractors send offers. You choose the best match ‚Äî fair prices, local pros.">

  <link rel="stylesheet" href="style.css"/>



  <!-- Font Awesome (icons) -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">



  <style>

    :root{ --logo-base:#0F2A43; --logo-accent:#F28C1B; --logo-em:#E63946; }

    .brand-logo{font-weight:800;font-size:24px;color:var(--logo-base);letter-spacing:.2px;text-shadow:0 1px 0 rgba(0,0,0,.05)}

    .brand-logo span{color:var(--logo-accent)} .brand-logo em{color:var(--logo-em);font-style:normal}

    .legal-links{padding:40px 16px;background:#f7f9fc;border-top:1px solid rgba(0,0,0,.06)}

    .legal-links h2{margin:0 0 6px;text-align:center}

    .legal-links .mega-sub{margin:0 0 22px;text-align:center;color:#5b6b7f}

    .legal-wrap{max-width:1100px;margin:0 auto;display:grid;gap:16px;grid-template-columns:repeat(3,minmax(0,1fr))}

    @media (max-width:800px){.legal-wrap{grid-template-columns:1fr}}

    .legal-card{display:flex;align-items:center;gap:12px;padding:18px 20px;border-radius:14px;text-decoration:none;color:#132033;background:#fff;border:1px solid rgba(0,0,0,.07);transition:.15s}

    .legal-card:hover{transform:translateY(-3px);box-shadow:0 10px 24px rgba(0,0,0,.08);border-color:rgba(0,0,0,.12)}

    /* modal & grid */

    .modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;padding:18px;z-index:50}

    .sheet{max-width:980px;width:100%;background:#0b1220;color:#e5e7eb;border-radius:16px;border:1px solid rgba(255,255,255,.08);padding:16px}

    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}

    @media(max-width:780px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}

    .icon{display:flex;align-items:center;gap:10px;background:linear-gradient(180deg,#111827,#0b1220);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:14px;cursor:pointer}

    .emoji{font-size:22px}

    .card{background:linear-gradient(180deg,#111827,#0b1220);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px}

    label{display:block;margin:.6rem 0 .2rem}

    input,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #334155;background:#0b1220;color:#e5e7eb}

    button.btn{padding:10px 14px;border-radius:10px;border:0;background:#2563eb;color:#fff;font-weight:700;cursor:pointer}

    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}

    .hint{opacity:.75;font-size:.9rem}

    .ok{color:#10b981}.err{color:#ef4444}

  </style>

</head>



<body>

  <!-- Header / Navbar -->

  <header>

    <nav style="display:flex;justify-content:space-between;align-items:center;padding:14px 16px">

      <div class="brand-logo">Pro<span>Build</span><em>Zone</em></div>

      <ul style="display:flex;gap:14px;list-style:none;margin:0;padding:0">

        <li><a href="#how">How it works</a></li>

        <li><a href="#services">Services</a></li>

        <li><a href="#pros" class="pro-btn">For Pros</a></li>

      </ul>

    </nav>

  </header>



  <!-- Hero -->

  <section class="hero" style="padding:28px 16px;text-align:center;background:#eef3f9">

    <h1>Get Home Projects Done ‚Äî Fair Prices, Local Pros.</h1>

    <p>Post your project with photos. Local contractors send offers. You choose the best match.</p>

    <div class="buttons" style="margin:12px 0">

      <a href="#services" class="btn" style="background:#2563eb;color:#fff;padding:10px 14px;border-radius:10px">Post a Job (Free)</a>

      <a href="#services" class="btn" style="background:#374151;color:#fff;padding:10px 14px;border-radius:10px">View Services</a>

      <button class="btn" id="openDoor" style="margin-left:8px;background:#111827;color:#fff">Open Upload Door</button>

    </div>

  </section>



  <!-- Legal/Info cards -->

  <section class="legal-links" id="services">

    <h2>Explore More</h2>

    <p class="mega-sub">Learn about our services, privacy practices, and terms.</p>

    <div class="legal-wrap">

      <a class="legal-card" href="services.html"><i class="fa-solid fa-list-check"></i><span>Services</span></a>

      <a class="legal-card" href="privacy.html"><i class="fa-solid fa-shield-halved"></i><span>Privacy Policy</span></a>

      <a class="legal-card" href="terms.html"><i class="fa-solid fa-scale-balanced"></i><span>Terms of Service</span></a>

    </div>

  </section>



  <!-- ===== Upload Door Modal ===== -->

  <div class="modal" id="modal">

    <div class="sheet">

      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">

        <h3 style="margin:6px 0 8px">Choose a category (12)</h3>

        <button class="btn" id="closeDoor" style="padding:8px 12px">Close</button>

      </div>



      <!-- 12 icons -->

      <div class="grid" id="iconGrid"></div>



      <!-- Uploader + Owner form -->

      <div id="uploaderArea" style="display:none">

        <h3 id="catTitle" style="margin-top:16px"></h3>



        <!-- Files -->

        <label class="icon" style="display:block;cursor:pointer">

          <input type="file" id="fileInput" multiple accept="image/*" style="display:none" />

          <div class="emoji">‚¨ÜÔ∏è</div>

          <span>Drop files here or click to choose</span>

        </label>

        <div class="card" id="fileList" style="margin-top:12px"></div>



        <!-- Owner form -->

        <div class="card" style="margin-top:12px">

          <h4>Owner details & project info</h4>

          <p class="hint">Private fields are hidden from pros until you approve them.</p>



          <label>Project title *</label>

          <input id="title" placeholder="e.g., Replace leaking roof" required/>



          <label>Short summary</label>

          <textarea id="summary" placeholder="One or two lines‚Ä¶"></textarea>



          <div class="row2">

            <div><label>City</label><input id="city"/></div>

            <div><label>State</label><input id="state"/></div>

          </div>



          <div class="row2">

            <div><label>Budget min</label><input id="budgetMin" type="number"/></div>

            <div><label>Budget max</label><input id="budgetMax" type="number"/></div>

          </div>



          <hr style="opacity:.2;margin:12px 0">



          <div class="row2">

            <div><label>Contact name *</label><input id="contactName" required/></div>

            <div><label>Phone *</label><input id="phone" required/></div>

          </div>

          <label>Email *</label><input id="email" type="email" required/>

          <label>Full address *</label><input id="address" required/>

          <label>Full description *</label><textarea id="longDesc" required placeholder="Describe the job in detail‚Ä¶"></textarea>



          <div style="display:flex;gap:10px;align-items:center;margin-top:10px">

            <button id="sendBtn" class="btn">üöÄ Post Job</button>

            <span id="sendMsg" class="hint"></span>

          </div>

        </div>

      </div>

    </div>

  </div>



  <!-- Supabase UMD -->

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js"></script>



  <!-- Main script -->

  <script>

    // ===== Config: ÿßÿ¨ÿπŸÑŸáÿß ŸÅÿßÿ±ÿ∫ÿ© ŸáŸÜÿß (ŸÜÿ≥ÿ™ÿπŸÖŸÑ ŸÖŸÅÿßÿ™Ÿäÿ≠ Vercel ŸÅŸä ÿßŸÑŸÄ API) =====

    const categories = [

      ['General Home Repairs','üõ†'],['Electrical','‚ö°'],['Plumbing','üö∞'],['Roofing & Gutters','üè†'],

      ['Painting','üé®'],['Flooring','üß±'],['Landscaping','üåø'],['HVAC','‚ùÑ'],['Basement','üèö'],

      ['Carpentry','üî®'],['Windows & Doors','üö™'],['Appliances','üîå']

    ];

    const modal = document.getElementById('modal');

    document.getElementById('openDoor').onclick = ()=>{ modal.style.display='flex'; };

    document.getElementById('closeDoor').onclick = ()=>{ modal.style.display='none'; };



    // Build grid

    const grid = document.getElementById('iconGrid');

    const uploader = document.getElementById('uploaderArea');

    const catTitle = document.getElementById('catTitle');

    let selectedCategory = null;

    categories.forEach(([name, emoji])=>{

      const div = document.createElement('div');

      div.className = 'icon';

      div.innerHTML = '<div class="emoji">'+emoji+'</div><div>'+name+'</div>';

      div.onclick = ()=>{

        selectedCategory = name;

        catTitle.textContent = 'Selected: '+name;

        uploader.style.display = 'block';

      };

      grid.appendChild(div);

    });



    // File list preview

    const fileInput = document.getElementById('fileInput');

    const fileList = document.getElementById('fileList');

    fileInput.addEventListener('change', ()=>{

      fileList.innerHTML = '';

      [...fileInput.files].forEach(f=>{

        const p = document.createElement('p'); p.textContent = f.name+' ('+Math.round(f.size/1024)+' KB)';

        fileList.appendChild(p);

      });

    });

    // Click area triggers input

    document.querySelector('label.icon').onclick = ()=>fileInput.click();



    // Helpers

    async function filesToBase64(fileList){

      const files = [...fileList||[]]; const arr=[];

      for (const f of files){

        const buf = await f.arrayBuffer();

        let bin=''; new Uint8Array(buf).forEach(b=>bin+=String.fromCharCode(b));

        arr.push(btoa(bin));

      }

      return arr;

    }



    // Submit

    document.getElementById('sendBtn').addEventListener('click', async ()=>{

      const m = document.getElementById('sendMsg');

      try{

        if(!selectedCategory){ m.textContent='Choose a category first.'; return; }

        const title = document.getElementById('title').value.trim();

        const summary = document.getElementById('summary').value.trim();

        const city = document.getElementById('city').value.trim();

        const state = document.getElementById('state').value.trim();

        const budget_min = document.getElementById('budgetMin').value || null;

        const budget_max = document.getElementById('budgetMax').value || null;

        const contact_name = document.getElementById('contactName').value.trim();

        const phone = document.getElementById('phone').value.trim();

        const email = document.getElementById('email').value.trim();

        const address = document.getElementById('address').value.trim();

        const description_long = document.getElementById('longDesc').value.trim();

        if(!title||!contact_name||!phone||!email||!address||!description_long){

          m.textContent='Please fill all required fields.'; return;

        }

        m.textContent='Uploading‚Ä¶';

        const photosBase64 = await filesToBase64(fileInput.files);



        // ÿ•ÿ∞ÿß ŸÑÿØŸäŸÉ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿØÿÆŸàŸÑ Supabaseÿå ŸÖÿ±ÿ± ÿßŸÑÿ™ŸàŸÉŸÜ ÿ≠ÿ™Ÿâ ÿ™Ÿèÿ∑ÿ®ŸÇ RLS ŸÑŸÑŸÖÿßŸÑŸÉ:

        const supa = window.supabase.createClient('%SUPABASE_URL%', '%SUPABASE_ANON%'); // ÿ™Ÿèÿ™ÿ±ŸÉ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿäÿ©

        const { data: { session } } = await supa.auth.getSession();

        const token = session?.access_token;



        const res = await fetch('/api/jobs/create', {

          method:'POST',

          headers: { 'Content-Type':'application/json', ...(token?{Authorization:'Bearer '+token}:{}) },

          body: JSON.stringify({

            category: selectedCategory, title, summary, city, state, budget_min, budget_max,

            address, contact_name, phone, email, description_long, photosBase64

          })

        });

        const j = await res.json();

        if(!res.ok || !j.ok) throw new Error(j.error||'Failed');

        m.textContent='Posted ‚úî Job ID: '+j.job_id; m.className='hint ok';

      }catch(e){ m.textContent='Error: '+(e.message||'failed'); m.className='hint err'; }

    });

  </script>

</body>

</html>
